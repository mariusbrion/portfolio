<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio de Marius Brion</title>
    <!-- Polices -->
    <link href="https://fonts.googleapis.com/css2?family=Shrikhand&display=swap" rel="stylesheet">
    <!-- Anime.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <!-- Lottie Web Component Officiel -->
    <script src="https://unpkg.com/@lottiefiles/dotlottie-wc@0.8.11/dist/dotlottie-wc.js" type="module"></script>
    <style>
        :root {
            --skills-bg: #f8f9fa;
            --skills-primary: #2c3e50;
            --skills-accent: #3498db;
            --neutral-bg: #f0f4f8; 
        }

        body, html {
            margin: 0;
            padding: 0;
            font-family: 'Times New Roman', serif;
            color: #333;
            scroll-behavior: smooth;
            overflow-x: hidden;
        }

        /* --- ACCUEIL --- */
        .home-section {
            position: relative;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
            overflow: hidden;
        }

        .video-background {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: -1;
        }

        .video-background video {
            width: 100%; height: 100%;
            object-fit: cover;
        }

        .name {
            position: absolute;
            top: 20px; left: 20px;
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            z-index: 2;
            font-family: 'Shrikhand', cursive;
        }

        h1 {
            font-size: 3rem;
            margin: 0;
            font-weight: normal;
            font-family: 'Shrikhand', cursive;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            line-height: 1.2;
            color: white;
        }

        .box-container {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            gap: 20px;
            z-index: 2;
        }

        .box {
            background-color: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            border-radius: 15px;
            padding: 10px 20px;
            width: 150px;
            text-align: center;
            font-family: 'Shrikhand', cursive;
            font-size: 1.2rem;
            color: white;
            cursor: pointer;
            transition: background-color 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 40px;
            text-decoration: none;
        }

        .box:hover {
            background-color: rgba(255, 255, 255, 0.4);
        }

        /* --- SECTIONS COMMUNES --- */
        .about-section, .creations-section, .contact-section {
            background-color: var(--neutral-bg);
            padding: 80px 20px;
            text-align: center;
        }

        .section-content {
            max-width: 900px;
            margin: 0 auto;
            transition: max-width 0.5s ease;
        }

        #creations-container.section-content {
            max-width: 1140px; 
        }

        .creations-section .section-content.wide {
            max-width: 1200px;
        }

        h2 {
            font-size: 2.5rem;
            font-family: 'Shrikhand', cursive;
            margin-bottom: 40px;
            color: #1a73e8;
            text-align: center;
        }

        p {
            font-size: 1.1rem;
            line-height: 1.6;
            text-align: justify;
            margin-bottom: 20px;
        }

        a { color: #1a73e8; text-decoration: none; font-weight: bold; }
        a:hover { color: #1557b0; }

        /* --- CR√âATIONS (GRILLE ET CARTES) --- */
        .creations-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr); 
            gap: 40px;
            margin: 0 auto;
            justify-items: center;
            width: fit-content;
        }

        .creation-card {
            background: #ffffff; 
            border: 2px solid #cbd5e1;
            border-radius: 2rem;
            padding: 40px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            width: 550px; 
            height: auto;
            aspect-ratio: 1.2 / 1; 
            box-sizing: border-box;
        }

        .creation-card:hover {
            border-color: #1a73e8;
            box-shadow: 0 15px 30px rgba(26, 115, 232, 0.1);
            transform: translateY(-5px);
        }

        .lottie-box {
            width: 250px; 
            height: 250px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
        }

        dotlottie-wc {
            width: 100%;
            height: 100%;
            display: block;
            aspect-ratio: 1/1;
        }

        .creation-card h3 {
            font-family: 'Shrikhand', cursive;
            font-size: 1.8rem;
            color: #1a73e8;
            margin: 10px 0 0 0;
        }

        /* --- NOUVEAU SYST√àME STACK --- */
        #stack-view { display: none; }
        
        /* En-t√™te global de la stack (Masqu√© comme demand√©) */
        .stack-header-global {
            display: none; 
        }

        /* Wrapper d'un projet individuel */
        .project-wrapper {
            background: var(--neutral-bg); /* Couleur de fond modifi√©e pour se fondre (#f0f4f8) */
            border-radius: 2rem;
            padding: 40px;
            border: 2px solid #cbd5e1;
            margin-bottom: 40px; /* Espace entre les projets empil√©s */
            opacity: 0; /* Pour l'animation d'entr√©e */
            scroll-margin-top: 100px; /* Pour que le scroll s'arr√™te un peu avant */
        }

        .project-header-inline {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            border-bottom: 1px solid #cbd5e1; /* L√©g√®rement plus fonc√© pour le contraste sur fond gris clair */
            padding-bottom: 20px;
        }

        .project-header-inline h3 {
            font-family: 'Shrikhand', cursive;
            font-size: 2rem;
            color: #1a73e8;
            margin: 0;
        }

        .other-nav {
            margin-top: 20px;
            padding-top: 20px;
            padding-bottom: 40px;
        }

        .other-nav-title {
            font-family: 'Shrikhand', cursive;
            color: #1a73e8;
            font-size: 1.1rem;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .other-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .nav-card-small {
            background: #ffffff; 
            padding: 15px 25px;
            border-radius: 1.5rem;
            border: 2px solid #cbd5e1;
            display: flex;
            align-items: center;
            gap: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Shrikhand', cursive;
            color: #475569;
        }

        .nav-card-small:hover {
            border-color: #1a73e8;
            color: #1a73e8;
            transform: scale(1.03);
            background: #f8fafc;
        }

        /* --- SECTION COMP√âTENCES --- */
        .skills-section {
            position: relative;
            height: 100vh;
            width: 100%;
            overflow: hidden;
            background-color: var(--skills-bg);
            padding: 0;
        }

        .skills-header-container {
            position: absolute;
            top: 40px;
            width: 100%;
            z-index: 10;
            pointer-events: none;
        }

        .background-anim {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            z-index: 1;
            opacity: 0;
        }
        .background-anim svg { width: 100%; height: 100%; }
        .background-anim path { stroke-width: 2; fill: none; }

        .main-container {
            position: relative;
            z-index: 2;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%; height: 100%;
            padding-top: 80px;
        }

        .bubbles-wrapper {
            position: relative;
            width: 100%;
            max-width: 750px;
            aspect-ratio: 1 / 1;
        }
        .bubbles-wrapper svg { width: 100%; height: 100%; }

        .satellite, #main-bubble { cursor: pointer; transition: filter 0.3s; }
        .satellite:hover, #main-bubble:hover { filter: brightness(1.1); }

        .bubble-text, .main-text, .central-hint, .satellite-hint {
            font-weight: 600;
            text-anchor: middle;
            pointer-events: none;
            text-transform: uppercase;
            opacity: 0;
            font-family: 'Segoe UI', Roboto, sans-serif;
        }

        .bubble-text { font-size: 11px; fill: var(--skills-primary); }
        .main-text { font-size: 13px; font-weight: 800; fill: white; }
        .central-hint { font-size: 10px; fill: #3498db; font-weight: 700; font-style: italic; }
        .satellite-hint { font-size: 9px; fill: var(--skills-accent); font-style: italic; }

        .circle-outline {
            fill: white; 
            fill-opacity: 1; 
            stroke: var(--skills-primary);
            stroke-width: 1.5;
            opacity: 0;
        }

        .ripple { fill: none; stroke: var(--skills-accent); stroke-width: 2; opacity: 0; }
        
        /* Correction : utilisation de la classe correcte correspondant √† l'HTML */
        .drop-line { stroke: var(--skills-primary); stroke-width: 3; stroke-linecap: round; }

        /* --- MODALES --- */
        .modal-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background: rgba(44, 62, 80, 0.85);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 800px; width: 90%;
            max-height: 85vh;
            overflow-y: auto;
            position: relative;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .modal-close {
            position: sticky; top: 0; float: right;
            background: var(--skills-primary); color: white;
            border: none; width: 30px; height: 30px; border-radius: 50%;
            cursor: pointer; font-weight: bold;
        }

        .modal-body h3 { 
            color: var(--skills-primary); 
            font-family: 'Shrikhand', cursive; 
            margin-top: 20px; 
            text-align: center;
            font-size: 1.8rem;
        }
        
        .modal-body p { line-height: 1.6; color: #34495e; text-align: justify; }
        .modal-body img { max-width: 100%; border-radius: 10px; margin: 20px auto; display: block; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .image-container { display: flex; gap: 15px; flex-wrap: wrap; }
        .image-container img { flex: 1; min-width: 200px; object-fit: cover; }
        .sheets-iframe { width: 100%; border: 1px solid #ddd; border-radius: 10px; margin-top: 15px; }

        @media (max-width: 1140px) {
            .creations-grid { grid-template-columns: 1fr; }
            .creation-card { width: 90%; max-width: 550px; }
            #creations-container.section-content { max-width: 900px; }
        }

        @media (max-width: 768px) {
            h1 { font-size: 2rem; }
            .creation-card { width: 90vw; aspect-ratio: auto; padding: 20px; }
            .skills-section { height: 90vh; }
            .bubbles-wrapper { transform: scale(0.75); }
        }
    </style>
</head>
<body>

    <!-- Accueil -->
    <section class="home-section">
        <div class="video-background">
            <video autoplay muted loop preload="auto" playsinline>
                <source src="https://videos.pexels.com/video-files/20046744/20046744-uhd_3840_2160_60fps.mp4" type="video/mp4">
            </video>
        </div>
        <div class="name">Marius Brion</div>
        <div class="content">
            <h1>√âtudiant en<br>Villes et Territoires Durables</h1>
        </div>
        <div class="box-container">
            <a href="#about-section" class="box">√Ä propos</a>
            <a href="#creations-section" class="box">Mes cr√©ations</a>
            <a href="#skills-section" class="box">Comp√©tences</a>
            <a href="#me-contacter-section" class="box">Contact</a>
        </div>
    </section>

    <!-- Section √Ä propos -->
    <section id="about-section" class="about-section">
        <div class="section-content">
            <h2>√Ä propos de moi</h2>
            <p>
                √âtudiant en <strong>troisi√®me ann√©e de BUT Villes et Territoires Durables</strong> √† l‚ÄôIUT Bordeaux Montaigne, je m‚Äôoriente vers les enjeux de <strong>mobilit√© durable</strong>, d‚Äôam√©nagement du territoire et d‚Äôanalyse territoriale. Mon parcours combine formation acad√©mique et exp√©riences en collectivit√©s, avec une attention particuli√®re port√©e √† l‚Äôefficacit√© des politiques publiques et √† l‚Äôusage de l‚Äôexistant.<br><br>
                Au cours de mes stages √† l‚Äôagglom√©ration du <a href="https://www.grand-chatellerault.fr/" target="_blank">Grand Ch√¢tellerault</a> (programme Action C≈ìur de Ville) et √† l‚Äô<a href="https://www.at86.fr/" target="_blank">Agence des Territoires de la Vienne</a>, j‚Äôai particip√© √† des projets d‚Äôam√©nagement et de d√©veloppement territorial en lien avec les enjeux de durabilit√©.<br><br>
                Je r√©alise actuellement une alternance d‚Äôun an en tant que <strong>charg√© de mobilit√©</strong> √† <a href="https://www.bordeaux-metropole.fr/" target="_blank">Bordeaux M√©tropole</a>, qui constitue une mise en application directe des enseignements de ma formation. J‚Äôy travaille notamment sur la pr√©paration de l‚Äôorganisation des mobilit√©s autour de l‚Äôarriv√©e d‚Äôun nouveau coll√®ge, en int√©grant les transports collectifs, les mobilit√©s actives et les contraintes urbaines existantes. Cette mission repose sur une coordination √©troite entre plusieurs partenaires (agence d‚Äôurbanisme, exploitant de transport Keolis, services m√©tropolitains), ainsi que sur l‚Äôarticulation avec des projets concomitants et un calendrier contraint, le coll√®ge devant ouvrir √† la rentr√©e 2026.<br><br>
                J‚Äôai √©galement conduit un <strong>diagnostic du r√©seau cyclable structurant</strong> √† l‚Äô√©chelle d‚Äôun regroupement de 11 communes, dans un contexte marqu√© par une forte acc√©l√©ration de la cr√©ation d‚Äôinfrastructures cyclables ces derni√®res ann√©es. Ce travail visait √† √©valuer l‚Äô√©tat du r√©seau existant, notamment la qualit√© des rev√™tements, les probl√©matiques de d√©gradation et de gestion des eaux pluviales, ainsi que les enjeux d‚Äôentretien √† moyen et long terme. L‚Äôobjectif √©tait d‚Äôobjectiver les effets cumul√©s de cette phase d‚Äôinvestissement rapide, afin d‚Äôorienter les politiques cyclables vers une gestion plus r√©aliste et soutenable, int√©grant les contraintes budg√©taires et la pr√©vention des co√ªts futurs.<br><br>
                Enfin, j‚Äôai men√© un <strong>diagnostic des mobilit√©s autour d‚Äôune √©cole primaire</strong>, int√©grant √† la fois les mobilit√©s actives et les transports en commun. Ce travail a mobilis√© des outils d‚Äôanalyse spatiale tels que la g√©olocalisation des √©l√®ves, l‚Äô√©valuation de la marchabilit√©, la production d‚Äôisochrones d‚Äôaccessibilit√©, et l‚Äô√©tude de dispositifs comme une potentielle rue aux √©coles, afin d‚Äôobjectiver les conditions d‚Äôacc√®s et de s√©curit√© aux abords de l‚Äô√©tablissement.<br><br>
                Ces exp√©riences nourrissent mon projet de poursuite d‚Äô√©tudes en <strong>master d‚Äôurbanisme</strong>, avec l‚Äôobjectif de contribuer √† des territoires plus sobres, fonctionnels et r√©silients, en particulier sur les enjeux de mobilit√©s du quotidien.
            </p>
        </div>
    </section>

    <!-- Mes cr√©ations -->
    <section id="creations-section" class="creations-section">
        <div id="creations-container" class="section-content">
            <h2>Mes cr√©ations</h2>
            
            <!-- VUE GRILLE (Initiale) -->
            <div id="grid-view" class="creations-grid">
                <div class="creation-card" onclick="openCreation('urbanisme3D')">
                    <div class="lottie-box">
                        <dotlottie-wc src="https://lottie.host/77dec24d-5a66-4f2c-8bcd-c1472f1f97e9/FIYSZhGA6a.lottie" autoplay loop></dotlottie-wc>
                    </div>
                    <h3>Urbanisme & 3D</h3>
                </div>
                <div class="creation-card" onclick="openCreation('analysespatiale')">
                    <div class="lottie-box">
                        <dotlottie-wc src="https://lottie.host/d3687639-c0e2-4ac7-a2b0-ec8ea6d8bb7f/S1wFjyFaZ8.lottie" autoplay loop></dotlottie-wc>
                    </div>
                    <h3>Analyse Spatiale</h3>
                </div>
                <div class="creation-card" onclick="openCreation('engagementcitoyen')">
                    <div class="lottie-box">
                        <dotlottie-wc src="https://lottie.host/f5abf154-652f-4b74-960b-392fed20ea94/qLLIgG1Ofm.lottie" autoplay loop></dotlottie-wc>
                    </div>
                    <h3>Engagement Citoyen</h3>
                </div>
                <div class="creation-card" onclick="openCreation('manipulationdonnes')">
                    <div class="lottie-box">
                        <dotlottie-wc src="https://lottie.host/648537b4-55e7-41de-a7e0-24f69717f801/I0AWbpzN4i.lottie" autoplay loop></dotlottie-wc>
                    </div>
                    <h3>Donn√©es</h3>
                </div>
            </div>

            <!-- VUE FLUX CONTINU (Stack) -->
            <div id="stack-view">
                <!-- En-t√™te global pour fermer (D√©sactiv√©) -->
                <div class="stack-header-global">
                    <button class="btn-back-global" onclick="closeStack()">Retour √† la grille √ó</button>
                </div>

                <!-- Conteneur des projets empil√©s -->
                <div id="details-stack"></div>

                <!-- Navigation persistante en bas -->
                <div id="stack-nav" class="other-nav">
                    <p class="other-nav-title">Continuer l'exploration</p>
                    <div id="stack-nav-grid" class="other-grid"></div>
                </div>
            </div>

        </div>
    </section>

    <!-- Mes comp√©tences -->
    <section id="skills-section" class="skills-section">
        <div class="skills-header-container">
            <h2>Mes comp√©tences</h2>
        </div>

        <div class="background-anim" id="bg-container">
            <svg viewBox="0 0 1100 800" xmlns="http://www.w3.org/2000/svg">
                <g fill="none" fill-rule="evenodd">
                    <path stroke="#31B495" d="M781.02 488.77v69.78c0 1.08-.88 1.96-1.97 1.96l-135.12-.04c-1.09 0-2.6.62-3.38 1.39l-39.23 38.96a5.52 5.52 0 0 1-3.37 1.4h-75.38a1.97 1.97 0 0 1-1.97-1.97v-33.5"/>
                <path stroke="#F4D21F" d="M674.88 355.57l45.54-45.24a5.42 5.42 0 0 0 1.39-3.35l-.06-10.38c0-1.08-.63-2.58-1.4-3.35l-43.38-43.07a1.94 1.94 0 0 1 0-2.77l82.83-82.25a5.52 5.52 0 0 1 3.37-1.4l44.94.1c1.08 0 2.6-.62 3.37-1.37L952.5 22.65"/>
                <path stroke="#1AACA8" d="M507-76.68v265.47a4 4 0 0 0 4 3.99H566c1.08 0 1.97.88 1.97 1.96v147.5c0 1.08-.63 2.59-1.4 3.35l-47.9 47.4a5.45 5.45 0 0 0-1.4 3.34c0 2.25.64 3.76 1.4 4.53l53.82 53.26c.77.76 1.76 1.39 2.19 1.39.43 0 .79.88.79 1.96v70.17c0 1.07-.89 1.96-1.97 1.96l-85.81-.04c-1.09 0-2.6.62-3.38 1.39l-1.55 1.54a5.52 5.52 0 0 1-3.38 1.4h-9.29"/>
                <path stroke="#1F8C43" d="M8 127.82v391.06a4.04 4.04 0 0 0 4 4.04L140.8 524"/>
                <path stroke="#1AA5D0" d="M894.01 374l49.8-49.44a5.52 5.52 0 0 1 3.37-1.4h92.41c1.09 0 2.6.63 3.38 1.4l27.18 26.99"/>
                <path stroke="#1F8C43" d="M755.16 213.9l70.82.04c1.08 0 2.6-.63 3.37-1.4l91.61-90.97a5.52 5.52 0 0 1 3.37-1.39h77.07l-71.29-72.13a5.45 5.45 0 0 1-1.4-3.35V16.87"/>
                <path stroke="#9DCA40" d="M261.78-52.44l11.16 11.08c.77.77 1.4 2.28 1.4 3.35V-5L156.7 111.03l-85.4 84.8a5.45 5.45 0 0 0-1.4 3.35v100.67c0 1.08.89 1.96 1.97 1.96h50.4c1.09 0 1.98.88 1.98 1.96l.07 26.92c0 1.07.9 1.96 1.98 1.96l335.73.13c1.09 0 1.98.88 1.98 1.96v36.79l-42.99 43.78a5.52 5.52 0 0 1-3.37 1.4H385.2"/>
                <path stroke="#DA5A98" d="M564.8 549.64v17.76c0 1.08-.64 2.59-1.4 3.35L382.28 750.6a5.52 5.52 0 0 1-3.38 1.39h-109.1c-1.09 0-1.97.88-1.97 1.96v23.37c0 1.07-.9 1.96-1.98 1.96h-83.54c-1.08 0-1.97.88-1.97 1.96v45.8c0 1.07.89 1.95 1.97 1.95h29.89c1.08 0 1.97.88 1.97 1.96v51.07c0 1.08.63 2.59 1.4 3.35l10.32 10.25c.77.76 2.29 1.39 3.37 1.39h111.77c1.09 0 1.34.62.57 1.39M482.82 656H630.9"/>
                <path stroke="#E5683E" d="M440.53 245.87l-31.7 31.48a5.52 5.52 0 0 1-3.37 1.39h-62.37c-1.09 0-2.6.62-3.38 1.39l-2.68 3.66-264.59.02c-1.08 0-2.6-.63-3.37-1.4l-47.3-46.97a5.52 5.52 0 0 0-3.37-1.39h-57.47l-1.12-34.61c0-1.08-.63-2.59-1.4-3.35l-66.54-65.94"/>
                <path stroke="#9F83B6" d="M705.31 221.73h7.83c1.09 0 2.6.63 3.37 1.4l45.8 45.6c.78.76 1.4 2.27 1.4 3.35v13.94c0 1.08.46 1.96 1.03 1.98.56 0 1.03.9 1.03 1.98v10.77l-.15 110.84c0 1.08-.89 1.96-1.98 1.96H628.32c-1.08 0-2.6-.63-3.37-1.4l-12.2-12.12a5.52 5.52 0 0 0-3.38-1.39h-46.18a2 2 0 0 0-2 1.96l-.17 26.74c0 1.08-.63 2.59-1.4 3.35l-8.82 8.76a5.52 5.52 0 0 1-3.37 1.39l-26.65-.06c-1.09 0-2.6.62-3.38 1.39l-48.1 47.78a5.52 5.52 0 0 1-3.38 1.39h-16.37l-79.45-.02c-1.09 0-2.6.63-3.36 1.39L220.71 639.06a5.47 5.47 0 0 1-3.35 1.4H31.06"/>
                <path stroke="#BC6D21" d="M145.43 99.41L289.6 243.5c.77.76 2.29 1.39 3.37 1.39h146.76c1.09 0 2.6.62 3.38 1.39l31.93 31.71c.77.77 1.4 2.27 1.4 3.35V474.1c0 1.08-.63 2.59-1.4 3.35l-7.6 7.54a5.52 5.52 0 0 1-3.36 1.4h-20.62l-20.67 20.97-2.78 2.78L289.37 640a5.45 5.45 0 0 0-1.4 3.35l.16 177.85"/>
                <path stroke="#DA1817" d="M318.82 380.62h94.88c1.09 0 2.6.63 3.38 1.39l14.97 14.87c.77.76 2.29 1.39 3.37 1.39h72.99c1.08 0 2.6.63 3.35 1.39l58.57 58.53c.77.77 2.27 1.4 3.35 1.4h103.37c1.08 0 1.97-.89 1.97-1.97v-14.7c0-1.09-.89-1.97-1.97-1.97l-6.7.02H630.1a1.97 1.97 0 0 1-1.97-1.96v-57c0-1.08-.63-2.59-1.4-3.35l-14.58-14.48a5.45 5.45 0 0 1-1.4-3.35v-17.3c0-1.07-.63-2.58-1.4-3.34L597 327.92a5.52 5.52 0 0 0-3.37-1.39h-17.4c-1.09 0-2.6-.62-3.38-1.39l-41.8-41.5a5.52 5.52 0 0 0-3.37-1.4h-41.34"/>
                <path stroke="#74BB63" d="M855.2 194.4h59.84c1.09 0 1.97.89 1.97 1.96v28.74c0 1.08.64 2.59 1.4 3.35l50.96 50.6c.77.76 1.4 2.27 1.4 3.35v101.47l105.2 104.27"/>
                <path stroke="#DA5A98" d="M638.46 305.73L651 293.29c.77-.74.77-2 0-2.76l-31.35-31.13c-.76-.74-.76-2 0-2.76l18.53-18.4a5.52 5.52 0 0 1 3.37-1.39l160.41-.2 423.37 1.2c1.08 0 1.97.89 1.97 1.96v71.5"/>
                <path stroke="#BC6D21" d="M438.61 486.03h-18.54c-1.08 0-2.6-.63-3.37-1.4l-74.94-74.41a5.52 5.52 0 0 0-3.37-1.4h-38.57c-1.08 0-2.6-.62-3.37-1.38l-47-46.68-36.58-.04-57 71.59a5.45 5.45 0 0 0-1.4 3.35v23.9"/>
                <path stroke="#74BB63" d="M882.06 358.97l-46.92 46.6a5.52 5.52 0 0 1-3.38 1.39h-94.64c-1.09 0-2.6-.63-3.38-1.4l-30.6-30.33a5.52 5.52 0 0 0-3.36-1.4l-34.94.04c-1.08 0-2.6.63-3.37 1.4l-29.57 29.36a5.52 5.52 0 0 1-3.37 1.39l-14.55-14.35a5.63 5.63 0 0 0-3.42-1.4l-156.97-.25c-1.11 0-2.65.63-3.43 1.4l-27.85 27.61a5.52 5.52 0 0 1-3.38 1.4H-23.82l-88.65.2-12.44 12.35"/>
                <path stroke="#2283BC" d="M292.9 643.74l59.56-59.12a5.52 5.52 0 0 1 3.37-1.39h23.93c1.08 0 2.6-.63 3.37-1.39l46.53-46.21a5.52 5.52 0 0 1 3.38-1.4h33.53l153.67-.01c1.08 0 1.97-.88 1.97-1.96V420.01c0-1.07-.63-2.58-1.4-3.35l-38.64-38.37a5.45 5.45 0 0 1-1.4-3.35v-51.52c0-1.08-.64-2.59-1.4-3.35L468.91 210.39a5.52 5.52 0 0 0-3.38-1.4l-180.49.2"/>
                <path stroke="#DA5A98" d="M484.13 548.71h-37.09c-1.08 0-2.6.63-3.37 1.4l-69.02 68.54c-.77.76-.77 2 0 2.76l28.09 27.78c.77.76 2.29 1.39 3.37 1.39h62.41"/>
                <path stroke="#31B495" d="M520.82 561.7v-4.74c0-1.08-.89-1.96-1.98-1.96h-13.21c-1.09 0-2.6-.62-3.37-1.39l-43.36-42.88a5.45 5.45 0 0 1-1.4-3.35v-190.4c0-1.08.63-2.6 1.4-3.36l20.89-20.74a5.45 5.45 0 0 0 1.4-3.35v-95.4c0-1.08-.63-2.58-1.4-3.35L292.4 4.7l-.6-40.88c0-1.08-.62-2.58-1.4-3.35L278.8-51.07"/>
                <path stroke="#1EB2D8" d="M275.76 745h99.28c1.09 0 2.6-.63 3.38-1.4l174.33-172.75a5.52 5.52 0 0 1 3.38-1.4h46.75c1.08 0 2.6-.62 3.35-1.38l51.47-51.46a5.42 5.42 0 0 0 1.38-3.35V311.29c0-1.07-.63-2.58-1.4-3.35l-51.84-51.3a5.52 5.52 0 0 0-3.38-1.4h-17.95a1.97 1.97 0 0 1-1.97-1.95v-44.47c0-1.07-.89-1.96-1.97-1.96h-88.63a1.97 1.97 0 0 1-1.97-1.96v-19.2c0-1.07-.64-2.58-1.4-3.34L309.87 4.92"/>
                <path stroke="#F4D21F" d="M1002.65 123.83H926.5c-1.08 0-2.6.62-3.37 1.39l-92.28 91.46a5.52 5.52 0 0 1-3.37 1.39l-131.87-.08c-1.09 0-2.6.63-3.37 1.37l-51.9 51.19c-.77.76-.77 2 0 2.76l21.22 21.1c.77.76 1.4 2.27 1.4 3.35v15.69"/>
                <path stroke="#BE2F39" d="M672.51 437.64h54.25c1.08 0 2.6.63 3.37 1.4l49.04 48.7c.77.76 2.29 1.38 3.37 1.38h45.16c1.08 0 2.6-.62 3.37-1.39L914.39 405a5.52 5.52 0 0 1 3.37-1.4h42.22c1.08 0 2.6.63 3.37 1.4l100.8 100.1"/>
                <path stroke="#E5683E" d="M672.51 434.31h55.63c1.08 0 2.6.63 3.37 1.4l49.14 48.8c.77.76 2.29 1.38 3.37 1.38l41.9-.04c1.08 0 2.6-.62 3.37-1.39l62.08-61.68a5.45 5.45 0 0 0 1.4-3.35l-.1-268.18c0-1.08-.63-2.59-1.4-3.35l-99.8-99.28a5.52 5.52 0 0 0-3.37-1.39H422.62c-1.08 0-2.6.63-3.37 1.4L260.28 206.3a5.52 5.52 0 0 1-3.38 1.39H127.3c-1.08 0-2.6.62-3.37 1.39l-36.71 36.45a5.45 5.45 0 0 0-1.4 3.35v185.1"/>
                <path stroke="#1EB2D8" d="M410.1 713.73l17.53 17.42c.77.76 2.29 1.39 3.37 1.39h42.02c1.09 0 2.6-.63 3.37-1.4l26.02-25.83 123.2-.31"/>
                <path stroke="#2283BC" d="M307.34 907.08c.77-.77.52-1.4-.57-1.4H108.29a1.97 1.97 0 0 1-1.98-1.95V743.59c0-1.08.9-1.96 1.98-1.96h264.38c1.09 0 2.6-.63 3.38-1.4l23.75-23.58c.77-.76.77-2 0-2.76l-80.84-80.1c-.77-.76-.51-1.4.57-1.4h137.53c1.09 0 2.6-.62 3.38-1.38l53.63-53.26a5.52 5.52 0 0 1 3.37-1.4l88.57-.2c1.09 0 2.6-.62 3.38-1.38l55.6-55.22a5.45 5.45 0 0 0 1.4-3.35V409.93c0-1.08.9-1.96 1.98-1.96h29c1.08 0 2.6-.63 3.37-1.4l43.32-43.01a5.52 5.52 0 0 1 3.37-1.4h6.11c1.09 0 2.6-.62 3.38-1.38l53.12-52.76a5.52 5.52 0 0 1 3.37-1.39h13.6c1.08 0 2.6.63 3.37 1.4L892.79 370c.77.77 2.29 1.4 3.37 1.4h74.06c1.08 0 2.6-.62 3.37 1.38l93.97 93.5"/>
                </g>
            </svg>
        </div>

        <div class="main-container">
            <div class="bubbles-wrapper">
                <svg viewBox="0 0 500 500">
                    <circle id="ripple" class="ripple" cx="250" cy="250" r="0"></circle>
                    <line id="drop-path" class="drop-line" x1="250" y1="0" x2="250" y2="20" opacity="0"></line>

                    <g class="satellite" data-skill="sig">
                        <circle class="circle-outline" cx="250" cy="70" r="45"></circle>
                        <text x="250" y="75" class="bubble-text">SIG / Carto</text>
                        <text x="250" y="93" class="satellite-hint">Cliquer !</text>
                    </g>
                    <g class="satellite" data-skill="langues">
                        <circle class="circle-outline" cx="430" cy="250" r="45"></circle>
                        <text x="430" y="245" class="bubble-text">Langues</text>
                        <text x="430" y="260" class="bubble-text">Outils</text>
                        <text x="430" y="275" class="satellite-hint">Cliquer !</text>
                    </g>
                    <g class="satellite" data-skill="visualisation">
                        <circle class="circle-outline" cx="250" cy="430" r="45"></circle>
                        <text x="250" y="435" class="bubble-text">Data Viz</text>
                        <text x="250" y="455" class="satellite-hint">Cliquer !</text>
                    </g>
                    <g class="satellite" data-skill="analyse">
                        <circle class="circle-outline" cx="70" cy="250" r="45"></circle>
                        <text x="70" y="252" class="bubble-text">Analyse</text>
                        <text x="70" y="272" class="satellite-hint">Cliquer !</text>
                    </g>

                    <g id="main-bubble" data-skill="central">
                        <circle id="main-circle-outline" class="circle-outline" cx="250" cy="250" r="75"></circle>
                        <circle id="main-circle-bg" fill="#2c3e50" cx="250" cy="250" r="0"></circle>
                        <text x="250" y="245" class="main-text">IUT BORDEAUX</text>
                        <text x="250" y="262" class="main-text">MONTAIGNE</text>
                        <text x="250" y="285" class="central-hint">Cliquer !</text>
                    </g>
                </svg>
            </div>
        </div>
    </section>

    <!-- Section Contact -->
    <section id="me-contacter-section" class="contact-section">
        <div class="section-content">
            <h2>Merci pour votre visite</h2>
            <p>
                Merci d‚Äôavoir pris le temps de parcourir mon portfolio. J‚Äôesp√®re que ces projets et analyses ont su refl√©ter mon engagement pour les territoires durables, ma curiosit√© intellectuelle et ma capacit√© √† mobiliser les outils d‚Äôanalyse pour comprendre les dynamiques urbaines.<br><br>
                Si vous souhaitez √©changer, me poser une question ou discuter d‚Äôune opportunit√©, n‚Äôh√©sitez pas √† me contacter. Vous pouvez √©galement t√©l√©charger mon CV ci-dessous pour obtenir une vue d‚Äôensemble de mon parcours.
            </p>
            <div class="contact-links">
                <a href="CV-Marius-Brion.pdf" target="_blank" class="box" style="display:inline-flex; width:auto; color:white; background-color: #1a73e8; border:none;">üëâ Mon CV</a>
                <a href="mailto:marius.brion@icloud.com" class="box" style="display:inline-flex; width:auto; color:white; background-color: #1a73e8; border:none;">üì¨ Contact</a>
            </div>
        </div>
    </section>

    <!-- MODALE COMP√âTENCES -->
    <div class="modal-overlay" id="skillModal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div class="modal-body" id="modalBody"></div>
        </div>
    </div>

    <!-- DONN√âES DES COMP√âTENCES -->
    <div id="skills-data" style="display:none">
        <div id="data-central">
            <h3>Acc√®s √† la culture en milieu carc√©ral : table ronde Festisol</h3>
            <p>Commission th√©matique "√âvasion culturelle" au sein de l'IUT Bordeaux Montaigne...</p>
            <div class="image-container">
                <img src="table_ronde_1.JPG" alt="Table ronde 1">
                <img src="table_ronde_2.JPG" alt="Table ronde 2">
            </div>
        </div>
        <div id="data-sig">
            <h3>SIG et Cartographie</h3>
            <p>Ma√Ætrise avanc√©e de QGIS...</p>
            <img src="cartopopulation.png" alt="Cartographie">
        </div>
        <div id="data-langues">
            <h3>Langues et Outils</h3>
            <p>Anglais B2+ (Cambridge C1)...</p>
            <div class="image-container">
                <img src="cambridge_cert_1.jpg" alt="Cambridge 1">
                <img src="cambridge_cert_2.jpg" alt="Cambridge 2">
            </div>
        </div>
        <div id="data-visualisation">
            <h3>Visualisation de Donn√©es</h3>
            <iframe class="sheets-iframe" src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTyCeQoxzkmSvx91E2jDk8VusqqxZAr6vvw6yBK4_gWB4NchnvDabFbZuJ3NlcWXCq8jv5QGznFqOmt/pubhtml?widget=true&headers=false" height="350"></iframe>
        </div>
        <div id="data-analyse">
            <h3>Analyse Territoriale</h3>
            <div class="image-container">
                <img src="emile-durkheim.jpg" alt="Socio">
                <img src="urban-typology.jpg" alt="Typologie">
            </div>
        </div>
    </div>

    <script>
        // --- LOGIQUE CR√âATIONS ---
        const categories = [
            { 
                id: 'urbanisme3D', 
                title: "Urbanisme & 3D", 
                lottie: "https://lottie.host/77dec24d-5a66-4f2c-8bcd-c1472f1f97e9/FIYSZhGA6a.lottie" 
            },
            { 
                id: 'analysespatiale', 
                title: "Analyse Spatiale", 
                lottie: "https://lottie.host/d3687639-c0e2-4ac7-a2b0-ec8ea6d8bb7f/S1wFjyFaZ8.lottie" 
            },
            { 
                id: 'engagementcitoyen', 
                title: "Engagement Citoyen", 
                lottie: "https://lottie.host/f5abf154-652f-4b74-960b-392fed20ea94/qLLIgG1Ofm.lottie" 
            },
            { 
                id: 'manipulationdonnes', 
                title: "Donn√©es", 
                lottie: "https://lottie.host/648537b4-55e7-41de-a7e0-24f69717f801/I0AWbpzN4i.lottie" 
            }
        ];

        let loadedProjects = []; // Suivi des projets d√©j√† dans la stack

        function scrollToCreations() {
            const section = document.getElementById('creations-section');
            if (section) {
                section.scrollIntoView({ behavior: 'smooth' });
                window.history.pushState(null, null, '#creations-section');
            }
        }

        function updateStackNav(currentId) {
            const navGrid = document.getElementById('stack-nav-grid');
            
            // On r√©cup√®re les cat√©gories qui NE SONT PAS l'actuelle
            const others = categories.filter(c => c.id !== currentId);
            
            // Tri : Ceux qui ne sont PAS encore ouverts (pas dans loadedProjects) apparaissent en premier
            others.sort((a, b) => {
                const aOpened = loadedProjects.includes(a.id);
                const bOpened = loadedProjects.includes(b.id);
                // aOpened est true (1) ou false (0). On veut false avant true.
                // Donc 0 - 1 = -1 (a vient avant b si a est ferm√© et b ouvert)
                return aOpened - bOpened;
            });
            
            navGrid.innerHTML = others.map(c => `
                <div class="nav-card-small" onclick="openCreation('${c.id}')">
                    <div style="width:40px; height:40px;">
                        <dotlottie-wc src="${c.lottie}" autoplay loop></dotlottie-wc>
                    </div>
                    <span>${c.title}</span>
                </div>
            `).join('');
        }

        async function openCreation(id) {
            const container = document.getElementById('creations-container');
            const gridView = document.getElementById('grid-view');
            const stackView = document.getElementById('stack-view');
            const stackContainer = document.getElementById('details-stack');
            const cat = categories.find(c => c.id === id);

            // --- CAS 1 : PREMI√àRE OUVERTURE (TRANSITION GRILLE -> STACK) ---
            if (gridView.style.display !== 'none') {
                // Figer la hauteur pour √©viter le glitch
                const currentHeight = container.offsetHeight;
                container.style.height = `${currentHeight}px`;
                container.style.overflow = 'hidden';

                gridView.style.display = 'none';
                stackView.style.display = 'block';
                container.classList.add('wide');
            }

            // --- CAS 2 : PROJET D√âJ√Ä CHARG√â (SCROLL SEULEMENT) ---
            if (loadedProjects.includes(id)) {
                // On lib√®re la hauteur si ce n'est pas d√©j√† fait
                container.style.height = 'auto'; 
                container.style.overflow = 'visible';
                
                const existingWrapper = document.getElementById(`project-${id}`);
                existingWrapper.scrollIntoView({ behavior: 'smooth' });
                
                // Mettre √† jour la nav du bas
                updateStackNav(id);
                return;
            }

            // --- CAS 3 : NOUVEAU PROJET (FETCH + APPEND) ---
            
            // Cr√©ation du Wrapper
            const wrapper = document.createElement('div');
            wrapper.id = `project-${id}`;
            wrapper.className = 'project-wrapper';
            wrapper.innerHTML = `
                <div class="project-header-inline">
                    <div style="width:120px; height:120px;"> <!-- Taille augment√©e ici -->
                        <dotlottie-wc src="${cat.lottie}" autoplay loop></dotlottie-wc>
                    </div>
                    <h3>${cat.title}</h3>
                </div>
                <div class="project-content-body">
                    <div style="text-align:center; padding:20px;">Chargement...</div>
                </div>
            `;
            
            // Ajout √† la stack
            stackContainer.appendChild(wrapper);
            loadedProjects.push(id);

            // Scroll imm√©diat vers le nouveau wrapper (qui a une taille par d√©faut)
            // Si c'est la premi√®re ouverture, on scroll vers le haut de la section
            // Sinon on scroll vers le nouveau projet
            if (loadedProjects.length === 1) {
                scrollToCreations();
            } else {
                wrapper.scrollIntoView({ behavior: 'smooth' });
            }

            // Mise √† jour de la nav du bas
            updateStackNav(id);

            // Fetch du contenu
            try {
                const response = await fetch(`./components/${id}.html`);
                if (!response.ok) throw new Error();
                const html = await response.text();
                
                // Injection
                wrapper.querySelector('.project-content-body').innerHTML = html;
                
                // Lib√©ration hauteur (si c'√©tait la premi√®re ouverture)
                container.style.height = 'auto'; 
                container.style.overflow = 'visible';

                // Animation d'entr√©e
                anime({
                    targets: wrapper,
                    opacity: [0, 1],
                    translateY: [20, 0],
                    duration: 600,
                    easing: 'easeOutQuad'
                });

            } catch (e) {
                wrapper.querySelector('.project-content-body').innerHTML = `<p style="text-align:center; padding: 20px;">Contenu indisponible.</p>`;
                container.style.height = 'auto';
                container.style.overflow = 'visible';
                wrapper.style.opacity = 1;
            }
        }

        function closeStack() {
            const container = document.getElementById('creations-container');
            const gridView = document.getElementById('grid-view');
            const stackView = document.getElementById('stack-view');
            const stackContainer = document.getElementById('details-stack');
            
            // 1. Figer hauteur
            const currentHeight = container.offsetHeight;
            container.style.height = `${currentHeight}px`;

            // 2. Reset UI
            stackView.style.display = 'none';
            gridView.style.display = 'grid';
            container.classList.remove('wide');
            
            // 3. Reset Logique
            stackContainer.innerHTML = '';
            loadedProjects = [];

            // 4. Scroll Top
            scrollToCreations();

            // 5. Lib√©rer hauteur
            setTimeout(() => {
                container.style.height = 'auto';
            }, 50);
        }


        // --- LOGIQUE COMP√âTENCES (Reste inchang√©e) ---
        const modal = document.getElementById('skillModal');
        const modalBody = document.getElementById('modalBody');

        function openModal(skillId) {
            const data = document.getElementById(`data-${skillId}`);
            if(data) {
                modalBody.innerHTML = data.innerHTML;
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            }
        }

        function closeModal() { 
            modal.style.display = 'none'; 
            document.body.style.overflow = 'auto';
        }

        window.onclick = (e) => { if(e.target == modal) closeModal(); }

        function initBackground() {
            document.querySelectorAll('.background-anim path').forEach(pathEl => {
                const offset = anime.setDashoffset(pathEl);
                pathEl.setAttribute('stroke-dashoffset', offset);
                anime({
                    targets: pathEl,
                    strokeDashoffset: [offset, 0],
                    duration: anime.random(1500, 3500),
                    delay: anime.random(0, 2000),
                    loop: true,
                    direction: 'alternate',
                    easing: 'easeInOutSine',
                    autoplay: true
                });
            });
        }

        let skillAnimPlayed = false;
        function runBubbleAnimation() {
            const tl = anime.timeline({ easing: 'easeOutExpo' });

            anime.set('#bg-container', { opacity: 0 });
            anime.set('.circle-outline', { opacity: 0, strokeDashoffset: anime.setDashoffset });
            anime.set('.main-text, .central-hint, .bubble-text, .satellite-hint', { opacity: 0 });
            anime.set('#main-circle-bg', { r: 0 });
            anime.set('#ripple', { r: 0, opacity: 0 });
            anime.set('#drop-path', { translateY: -50, opacity: 0 });

            tl
            .add({
                targets: '#drop-path',
                translateY: [0, 240],
                opacity: [0, 1, 0],
                duration: 700,
                easing: 'easeInQuad'
            })
            .add({
                targets: '#main-circle-outline',
                opacity: [0, 1],
                strokeDashoffset: [anime.setDashoffset, 0],
                duration: 800,
                offset: '-=100'
            })
            .add({
                targets: '#main-circle-bg',
                r: [0, 75],
                duration: 600,
                easing: 'easeOutBack',
                offset: '-=600'
            })
            .add({
                targets: '.main-text, .central-hint',
                opacity: [0, 1],
                translateY: [10, 0],
                duration: 500,
                offset: '-=400'
            })
            .add({
                targets: '#ripple',
                r: [0, 220],
                opacity: [1, 0],
                strokeWidth: [4, 0.5],
                duration: 1200,
                easing: 'easeOutQuart',
                offset: '-=400'
            })
            .add({
                targets: '.satellite .circle-outline',
                opacity: [0, 1],
                strokeDashoffset: [anime.setDashoffset, 0],
                duration: 700,
                delay: anime.stagger(100),
                offset: '-=900'
            })
            .add({
                targets: '.bubble-text, .satellite-hint',
                opacity: [0, 1],
                translateY: [10, 0],
                duration: 500,
                delay: anime.stagger(100),
                offset: '-=700'
            })
            .add({
                targets: '#bg-container',
                opacity: [0, 0.5],
                duration: 1000,
                offset: '-=500'
            })
            .add({
                targets: '.satellite',
                translateY: [0, -5, 0],
                duration: 2500,
                loop: true,
                direction: 'alternate',
                easing: 'easeInOutQuad',
                delay: anime.stagger(200)
            });
        }

        const skillObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !skillAnimPlayed) {
                    runBubbleAnimation();
                    skillAnimPlayed = true;
                }
            });
        }, { threshold: 0.75 });

        window.onload = () => {
            initBackground();
            const skillSec = document.getElementById('skills-section');
            if(skillSec) skillObserver.observe(skillSec);
            
            document.querySelectorAll('.satellite, #main-bubble').forEach(el => {
                el.addEventListener('click', () => openModal(el.getAttribute('data-skill')));
            });
        };
    </script>
</body>
</html>
