<div class="portfolio-container" style="font-family: system-ui, -apple-system, sans-serif; max-width: 1200px; margin: 0 auto; color: #374151; line-height: 1.6; padding: 40px; background-color: #f0f4f8;">

    <!-- SECTION 1 : ACCESSIBILITÉ SCOLAIRE (ISOCHRONES) -->
    <div class="project-section" style="margin-bottom: 60px;">
        
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            1. Accessibilité scolaire sur la commune du Haillan | vue isochrone
        </h3>

        <!-- DECLENCHEUR JS : Force l'exécution du code après l'injection fetch -->
        <img src="trigger" onerror="(function(){
            const maps = ['pieton-map', 'velo-map', 'bus-map'];
            const activeColor = '#0ea5e9';
            const inactiveColor = '#e2e8f0';
            const activeTextColor = '#ffffff';
            const inactiveTextColor = '#475569';

            window.showMap = function(mapId) {
                maps.forEach(id => {
                    const img = document.getElementById(id);
                    if (img) {
                        img.style.display = 'none';
                        img.style.opacity = '0';
                    }
                    const btn = document.getElementById(id.replace('map', 'btn'));
                    if (btn) {
                        btn.style.backgroundColor = inactiveColor;
                        btn.style.color = inactiveTextColor;
                    }
                });

                const selectedImg = document.getElementById(mapId);
                if (selectedImg) {
                    selectedImg.style.display = 'block';
                    setTimeout(() => { selectedImg.style.opacity = '1'; }, 20);
                }

                const selectedBtn = document.getElementById(mapId.replace('map', 'btn'));
                if (selectedBtn) {
                    selectedBtn.style.backgroundColor = activeColor;
                    selectedBtn.style.color = activeTextColor;
                }
            };

            // Initialisation par défaut sur le mode VÉLO
            window.showMap('velo-map');
        })()" style="display:none;">

        <!-- CONTENEUR DE LA CARTE INTERACTIVE -->
        <div class="map-wrapper" style="position: relative; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.1); background: #fff; margin-bottom: 25px;">
            <div style="position: relative; width: 100%; padding-top: 60%;">
                <img id="main-map" src="carte_principale.png" alt="Carte principale" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1;">
                <img id="pieton-map" class="overlay-map" src="carte_pieton.png" alt="Isochrone piéton" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
                <img id="velo-map" class="overlay-map" src="carte_velo.png" alt="Isochrone vélo" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
                <img id="bus-map" class="overlay-map" src="carte_voiture.png" alt="Isochrone bus" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
            </div>
        </div>

        <!-- BOUTONS -->
        <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
            <button id="pieton-btn" onclick="window.showMap('pieton-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; background-color: #e2e8f0; color: #475569;">Piéton</button>
            <button id="velo-btn" onclick="window.showMap('velo-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; background-color: #e2e8f0; color: #475569;">Vélo</button>
            <button id="bus-btn" onclick="window.showMap('bus-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; background-color: #e2e8f0; color: #475569;">Bus</button>
        </div>

        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
            <p style="margin-bottom: 1.2rem;">
                Ce module permet de comparer les temps d’accès aux écoles maternelles et élémentaires du centre du Haillan en alternant entre trois cartographies distinctes à l'aide des boutons de contrôle (la marche, le vélo et le bus). Réalisée sous <strong>QGIS</strong> à partir des données OpenStreetMap et d’un algorithme de calcul d’isochrones, cette analyse permet une lecture comparative de l’accessibilité scolaire à l’échelle de la commune.
            </p>
            <p style="margin-bottom: 1.2rem;">
                Les zones colorées traduisent des distances-temps, la teinte violette correspondant à un accès en moins de 10 minutes. Chaque point est associé à un temps estimé, exprimé en minutes, nécessaire pour rejoindre l’établissement depuis ce lieu.
            </p>
            <p style="margin-bottom: 1.2rem;">
                La comparaison des isochrones met en évidence des écarts marqués entre les modes de déplacement : le vélo dessine une zone d’accessibilité plus homogène et continue, tandis que le bus apparaît fortement contraint par le tracé des lignes et leur maillage. Cette lecture fait également ressortir des discontinuités du réseau viaire, notamment à l’est du secteur étudié, où une rue sans issue génère une véritable <strong>« fracture urbaine »</strong>. Celle-ci se matérialise par une dent claire au sein d’une zone pourtant globalement bien desservie.
            </p>
            <p style="font-style: italic; border-top: 2px solid #e2e8f0; padding-top: 1.5rem; margin-top: 1.5rem; color: #6b7280;">
                Cette représentation reste toutefois théorique : elle ne prend pas en compte les adresses réelles des élèves ni la qualité effective des cheminements et des aménagements. Pour dépasser cette limite, elle se compléte par une analyse des flux de déplacements scolaires, visant à rapprocher le potentiel d’accessibilité des usages probables.
            </p>
        </div>
    </div>

    <!-- SÉPARATEUR -->
    <div style="display: flex; align-items: center; justify-content: center; margin: 60px 0;">
        <div style="height: 1px; background: linear-gradient(to right, transparent, #cbd5e1, transparent); width: 80%;"></div>
    </div>

    <!-- SECTION 2 : FLOW -->
    <div class="project-section" style="margin-bottom: 60px;">
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            2. Cartographie des flux de cheminements piétons théoriques
        </h3>

        <div style="border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); background: white; margin-bottom: 25px;">
            <img src="flow.png" alt="Flux piétons théoriques" style="width: 100%; display: block;">
        </div>

        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
            <p style="margin-bottom: 1.2rem;">
                Cette cartographie de flux modélise les cheminements piétons théoriques vers l’établissement scolaire à partir des <strong>adresses d’élèves anonymisées</strong>. Elle permet de spatialiser le potentiel de passage sur chaque tronçon du réseau viaire et d’identifier les axes les plus susceptibles d’être empruntés par les écoliers.
            </p>
            <p style="margin-bottom: 1.2rem;">
                L’objectif n’est pas de prédire des trajets individuels, mais de faire émerger des axes à enjeux, caractérisés par une concentration potentielle des flux. Cette lecture linéaire complète l’approche surfacique des isochrones en introduisant une hiérarchisation des itinéraires.
            </p>
            <p style="font-style: italic; border-top: 2px solid #e2e8f0; padding-top: 1.5rem; margin-top: 1.5rem; color: #6b7280;">
                Cette modélisation constitue un outil d’aide à la décision pour orienter les diagnostics de terrain : elle permet de cibler en priorité les cheminements présentant le plus fort potentiel de fréquentation et, par conséquent, les axes majeurs à prendre en compte lors du diagnostic terrain.
            </p>
        </div>
    </div>

    <!-- SÉPARATEUR -->
    <div style="display: flex; align-items: center; justify-content: center; margin: 60px 0;">
        <div style="height: 1px; background: linear-gradient(to right, transparent, #cbd5e1, transparent); width: 80%;"></div>
    </div>

    <!-- SECTION 3 : FLUX DOMICILE TRAVAIL -->
    <div class="project-section" style="margin-bottom: 60px;">
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            3. Cartographie des flux domicile-travail | Changement d’échelle
        </h3>

        <div style="border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); background: white; margin-bottom: 25px;">
            <img src="fluxdomicile.png" alt="Flux domicile-travail" style="width: 100%; display: block;">
        </div>

        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
            <p style="margin-bottom: 1.2rem;">
                Cette cartographie permet d’élargir la lecture des mobilités au fonctionnement global du territoire. L’analyse des flux domicile-travail offre une compréhension macro des déplacements quotidiens et permet de replacer l’école dans un système de mobilités plus large.
            </p>
            <p style="margin-bottom: 1.2rem;">
                Cette représentation met en évidence les grandes tendances de circulation, comme ici des flux majoritaires orientés vers le nord-est, révélant des territoires fonctionnels structurés par les déplacements pendulaires. Elle permet notamment d’anticiper les zones de congestion, les risques de bouchons aux heures de pointe ou encore les secteurs propices à l’implantation de zones de dépose-minute.
            </p>
            <p style="font-style: italic; border-top: 2px solid #e2e8f0; padding-top: 1.5rem; margin-top: 1.5rem; color: #6b7280;">
                En complément des flux scolaires, cette approche élargie aide à comprendre les interactions entre mobilités actives, trafic automobile et usages quotidiens, en apportant un cadre de lecture stratégique aux enjeux observés à l’échelle locale.
            </p>
        </div>
    </div>

    <!-- SÉPARATEUR -->
    <div style="display: flex; align-items: center; justify-content: center; margin: 60px 0;">
        <div style="height: 1px; background: linear-gradient(to right, transparent, #cbd5e1, transparent); width: 80%;"></div>
    </div>

    <!-- SECTION 4 : DIAGNOSTIC DE TERRAIN -->
    <div class="project-section" style="margin-bottom: 40px;">
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            4. Diagnostic de terrain | Étude de marchabilité
        </h3>

        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563; margin-bottom: 2rem;">
            <p style="margin-bottom: 1.2rem;">
                L’ensemble de ces analyses cartographiques permet de pré-identifier des itinéraires prioritaires en fonction des modes de déplacement et du nombre potentiel d’élèves concernés. Ces résultats servent de base à la réalisation d’un diagnostic de terrain, visant à confronter la vision théorique de la cartographie à la réalité des usages et des aménagements.
            </p>
            <p style="margin-bottom: 1.2rem;">
                Le <strong>diagnostic de marchabilité</strong> permet d’évaluer concrètement la qualité des cheminements : continuités piétonnes, lisibilité, sécurité, entretien et usages effectifs de l’espace public. Ce diagnostic se couple à une <strong>concertation habitante</strong> pour mieux saisir les usages et définir des itinéraires cohérents, prenant en compte les habitudes des habitants. Il met également en lumière des dysfonctionnements non-visibles à l’échelle cartographique, tels que le stationnement sur les cheminements, l’encombrement des voies vertes ou le manque d’entretien de la végétation débordante.
            </p>
            <p>
                Cet exemple de restitution prend la forme d’un outil interactif, combinant photographies géolocalisées, tableau de suivi et estimations de coûts. Chaque point diagnostiqué est associé à des ordres de grandeur financiers, aux acteurs responsables et aux lieux concernés, permettant de passer d’un diagnostic spatial à une logique opérationnelle et hiérarchisée.
            </p>
        </div>

        <!-- IFRAME DU SITE ST-MEDARD -->
        <div style="width: 100%; height: 750px; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid #e2e8f0; background: #fff;">
            <iframe src="https://mariusbrion.github.io/st-medard/" style="width: 100%; height: 100%; border: none;" title="Diagnostic Saint-Médard"></iframe>
        </div>

        <!-- NOTE DE PRECISION -->
        <p style="font-style: italic; font-size: 0.9rem; color: #94a3b8; margin-top: 40px; text-align: center; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            Note : L'ensemble de ces représentations cartographiques constitue une démonstration méthodologique. Bien qu'elles portent sur des territoires distincts (Saint-Médard, Le Haillan, Le Taillan-Médoc) et utilisent des données modifiées à des fins d'anonymisation, elles illustrent la cohérence d'une démarche de diagnostic complète.
        </p>
    </div>

</div>
