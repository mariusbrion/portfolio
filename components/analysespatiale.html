<div class="portfolio-container" style="font-family: system-ui, -apple-system, sans-serif; max-width: 1200px; margin: 0 auto; color: #374151; line-height: 1.6; padding: 40px; background-color: #f0f4f8;">

    <!-- SECTION 1 : ACCESSIBILITÉ SCOLAIRE (ISOCHRONES) -->
    <div class="project-section" style="margin-bottom: 60px;">
        
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            Accessibilité scolaire sur la commune du Haillan : vue isochrone
        </h3>

        <!-- DECLENCHEUR JS : Force l'exécution du code après l'injection fetch -->
        <img src="trigger" onerror="(function(){
            const maps = ['pieton-map', 'velo-map', 'bus-map'];
            const activeColor = '#0ea5e9';
            const inactiveColor = '#e2e8f0';
            const activeTextColor = '#ffffff';
            const inactiveTextColor = '#475569';

            window.showMap = function(mapId) {
                maps.forEach(id => {
                    const img = document.getElementById(id);
                    if (img) {
                        img.style.display = 'none';
                        img.style.opacity = '0';
                    }
                    const btn = document.getElementById(id.replace('map', 'btn'));
                    if (btn) {
                        btn.style.backgroundColor = inactiveColor;
                        btn.style.color = inactiveTextColor;
                    }
                });

                const selectedImg = document.getElementById(mapId);
                if (selectedImg) {
                    selectedImg.style.display = 'block';
                    setTimeout(() => { selectedImg.style.opacity = '1'; }, 20);
                }

                const selectedBtn = document.getElementById(mapId.replace('map', 'btn'));
                if (selectedBtn) {
                    selectedBtn.style.backgroundColor = activeColor;
                    selectedBtn.style.color = activeTextColor;
                }
            };

            window.showMap('bus-map');
        })()" style="display:none;">

        <!-- CONTENEUR DE LA CARTE INTERACTIVE -->
        <div class="map-wrapper" style="position: relative; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.1); background: #fff; margin-bottom: 25px;">
            <div style="position: relative; width: 100%; padding-top: 60%; /* Ratio 5:3 */">
                <img id="main-map" src="carte_principale.png" alt="Carte principale" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1;">
                <img id="pieton-map" class="overlay-map" src="carte_pieton.png" alt="Isochrone piéton" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
                <img id="velo-map" class="overlay-map" src="carte_velo.png" alt="Isochrone vélo" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
                <img id="bus-map" class="overlay-map" src="carte_voiture.png" alt="Isochrone bus" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
            </div>
        </div>

        <!-- BOUTONS -->
        <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
            <button id="pieton-btn" onclick="window.showMap('pieton-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; background-color: #e2e8f0; color: #475569;">Piéton</button>
            <button id="velo-btn" onclick="window.showMap('velo-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; background-color: #e2e8f0; color: #475569;">Vélo</button>
            <button id="bus-btn" onclick="window.showMap('bus-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; background-color: #e2e8f0; color: #475569;">Bus</button>
        </div>

        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
            <p style="margin-bottom: 1.2rem;">
                Cette cartographie interactive représente les temps d’accès aux écoles maternelles et élémentaires du centre du Haillan selon trois modes de déplacement : la marche, le vélo et le bus. Réalisée sous <strong>QGIS</strong> à partir des données OpenStreetMap et d’un algorithme de calcul d’isochrones, elle permet une lecture fine et comparative de l’accessibilité scolaire à l’échelle du tissu urbain.
            </p>
            <p style="margin-bottom: 1.2rem;">
                La comparaison des isochrones met en évidence des écarts marqués d’efficacité entre les modes de transport : le vélo dessine une zone d’accessibilité plus homogène et continue, tandis que le bus reste fortement dépendant du tracé des lignes et de leur maillage. Cette lecture révèle également des discontinuités du réseau viaire, notamment à l’est du secteur étudié, où une <strong>rue en cul-de-sac génère une véritable « fracture urbaine »</strong>, visible sous la forme d’une dent claire dans une zone pourtant globalement bien desservie.
            </p>
            <p style="font-style: italic; border-top: 2px solid #e2e8f0; padding-top: 1.5rem; margin-top: 1.5rem; color: #6b7280;">
                L’outil dépasse ainsi la simple représentation des temps de parcours pour devenir un support d’analyse des choix d’aménagement, mettant en lumière l’influence conjointe de la morphologie urbaine, du maillage viaire et des modes de déplacement sur l’accessibilité quotidienne.
            </p>
        </div>
    </div>

    <!-- SÉPARATEUR -->
    <div style="display: flex; align-items: center; justify-content: center; margin: 60px 0;">
        <div style="height: 1px; background: linear-gradient(to right, transparent, #cbd5e1, transparent); width: 80%;"></div>
    </div>

    <!-- SECTION 2 : ANALYSE DES CHEMINEMENTS -->
    <div class="project-section" style="margin-bottom: 60px;">
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            Analyse des cheminements et dynamiques de flux
        </h3>

        <!-- PARTIE 1 : FLOW -->
        <div style="margin-bottom: 40px;">
            <div style="border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); background: white; margin-bottom: 20px;">
                <img src="flow.png" alt="Flux piétons théoriques" style="width: 100%; display: block;">
            </div>
            <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
                <p>
                    Grâce à la <strong>géolocalisation anonymisée</strong> des adresses des élèves, nous définissons des trajets théoriques permettant de déterminer précisément quels axes doivent être diagnostiqués et aménagés en priorité. Cette modélisation du potentiel de passage sur chaque tronçon permet d'orienter les investissements publics vers les cheminements les plus fréquentés par les écoliers.
                </p>
            </div>
        </div>

        <!-- PARTIE 2 : FLUX DOMICILE TRAVAIL -->
        <div style="margin-bottom: 40px;">
            <div style="border-radius: 12px; overflow: hidden; box-shadow: 0 4px 15px rgba(0,0,0,0.08); background: white; margin-bottom: 20px;">
                <img src="fluxdomicile.png" alt="Flux domicile-travail" style="width: 100%; display: block;">
            </div>
            <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
                <p>
                    Dans un second temps, l'analyse des <strong>flux domicile-travail</strong> permet d'adopter une vision plus globale du territoire. Elle aide à anticiper les zones de dépose des enfants et les potentiels points de congestion, offrant une compréhension macro des mouvements quotidiens qui viennent s'ajouter aux mobilités scolaires.
                </p>
            </div>
        </div>
    </div>

    <!-- SÉPARATEUR -->
    <div style="display: flex; align-items: center; justify-content: center; margin: 60px 0;">
        <div style="height: 1px; background: linear-gradient(to right, transparent, #cbd5e1, transparent); width: 80%;"></div>
    </div>

    <!-- SECTION 3 : SAINT-MÉDARD (SITE EXTERNE) -->
    <div class="project-section" style="margin-bottom: 40px;">
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            Diagnostic de terrain : Étude de marchabilité (Saint-Médard)
        </h3>

        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563; margin-bottom: 2rem;">
            <p>
                Le <strong>diagnostic de marchabilité</strong> constitue la suite logique et concrète de ces analyses théoriques. Il permet de passer de la modélisation spatiale à l'expertise de terrain à partir d’itinéraires définis. Ce travail intègre des estimations de coût des travaux et identifie les responsabilités (services techniques, riverains, mairie) pour transformer l'analyse en plan d'action opérationnel.
            </p>
        </div>

        <!-- IFRAME DU SITE ST-MEDARD -->
        <div style="width: 100%; height: 750px; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 30px rgba(0,0,0,0.15); border: 1px solid #e2e8f0; background: #fff;">
            <iframe src="https://mariusbrion.github.io/st-medard/" style="width: 100%; height: 100%; border: none;" title="Diagnostic Saint-Médard"></iframe>
        </div>

        <!-- NOTE DE PRECISION -->
        <p style="font-style: italic; font-size: 0.9rem; color: #94a3b8; margin-top: 40px; text-align: center; border-top: 1px solid #e2e8f0; padding-top: 20px;">
            Note : L'ensemble de ces représentations cartographiques ne portent pas sur le même territoire. Les données de flux géolocalisées ont été modifiées dans le but de présenter un exemple de démarche complète.
        </p>
    </div>

</div>
