<div class="portfolio-container" style="font-family: system-ui, -apple-system, sans-serif; max-width: 1200px; margin: 0 auto; color: #374151; line-height: 1.6; padding: 40px; background-color: #f0f4f8;">

    <!-- SECTION : ACCESSIBILITÉ SCOLAIRE -->
    <div class="project-section" style="margin-bottom: 40px;">
        
        <h3 style="color: #111827; font-size: 1.75rem; font-weight: 700; margin-bottom: 1.5rem; border-left: 5px solid #0ea5e9; padding-left: 20px;">
            Accessibilité scolaire sur la commune du Haillan : vue isochrone
        </h3>

        <!-- ASTUCE D'INJECTION : Ce petit élément permet de forcer l'exécution du JS après un fetch innerHTML -->
        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" style="display:none;" onerror="(function(){
            const container = document.querySelector('.portfolio-container');
            if (!container || window.spatialAnalysisInitialized) return;
            
            const maps = ['pieton-map', 'velo-map', 'bus-map'];
            const activeColor = '#0ea5e9';
            const inactiveColor = '#e2e8f0';
            const activeTextColor = '#ffffff';
            const inactiveTextColor = '#475569';

            window.showMap = function(mapId) {
                maps.forEach(id => {
                    const img = document.getElementById(id);
                    if (img) {
                        img.style.display = 'none';
                        img.style.opacity = '0';
                    }
                    const btn = document.getElementById(id.replace('map', 'btn'));
                    if (btn) {
                        btn.style.backgroundColor = inactiveColor;
                        btn.style.color = inactiveTextColor;
                    }
                });

                const selectedImg = document.getElementById(mapId);
                if (selectedImg) {
                    selectedImg.style.display = 'block';
                    setTimeout(() => { selectedImg.style.opacity = '1'; }, 50);
                }

                const selectedBtn = document.getElementById(mapId.replace('map', 'btn'));
                if (selectedBtn) {
                    selectedBtn.style.backgroundColor = activeColor;
                    selectedBtn.style.color = activeTextColor;
                }
            };

            const initAnimation = () => {
                maps.forEach((id, index) => {
                    setTimeout(() => { window.showMap(id); }, index * 800);
                });
                setTimeout(() => { window.showMap('bus-map'); }, maps.length * 800);
            };

            initAnimation();
            window.spatialAnalysisInitialized = true;
        })()">

        <!-- CONTENEUR DE LA CARTE INTERACTIVE -->
        <div class="map-wrapper" style="position: relative; width: 100%; border-radius: 12px; overflow: hidden; box-shadow: 0 10px 25px rgba(0,0,0,0.1); background: #fff; margin-bottom: 25px;">
            <div style="position: relative; width: 100%; padding-top: 60%; /* Ratio 5:3 */">
                <!-- Carte de base -->
                <img id="main-map" src="carte_principale.png" alt="Carte principale de l'école" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 1;">
                
                <!-- Overlays isochrones -->
                <img id="pieton-map" class="overlay-map" src="carte_pieton.png" alt="Carte isochrone piéton" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
                <img id="velo-map" class="overlay-map" src="carte_velo.png" alt="Carte isochrone vélo" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
                <img id="bus-map" class="overlay-map" src="carte_voiture.png" alt="Carte isochrone bus" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; z-index: 2; display: none; transition: opacity 0.5s ease; opacity: 0;">
            </div>
        </div>

        <!-- BOUTONS DE CONTRÔLE -->
        <div style="display: flex; justify-content: center; gap: 15px; margin-bottom: 30px;">
            <button id="pieton-btn" onclick="window.showMap('pieton-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; transition: all 0.3s ease; background-color: #e2e8f0; color: #475569;">
                Piéton
            </button>
            <button id="velo-btn" onclick="window.showMap('velo-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; transition: all 0.3s ease; background-color: #e2e8f0; color: #475569;">
                Vélo
            </button>
            <button id="bus-btn" onclick="window.showMap('bus-map')" style="cursor: pointer; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; transition: all 0.3s ease; background-color: #e2e8f0; color: #475569;">
                Bus
            </button>
        </div>

        <!-- DESCRIPTION -->
        <div style="font-size: 1.05rem; text-align: justify; color: #4b5563;">
            <p style="margin-bottom: 1.2rem;">
                Cette cartographie interactive montre les temps d’accès aux écoles élémentaire et maternelle du centre du Haillan selon trois modes de transport : à pied, à vélo et en bus. Réalisée à l’aide des données d’OpenStreetMap et d’un algorithme de calcul d’isochrones sous <strong>QGIS</strong>, elle permet de visualiser finement la répartition temporelle des déplacements vers l’école.
            </p>
            <p style="margin-bottom: 1.2rem;">
                Les zones colorées indiquent les distances-temps : la zone violette correspond à un accès en moins de 10 minutes. Chaque point est associé à un chiffre représentant le temps estimé, en minutes, nécessaire pour rejoindre l’école depuis ce point.
            </p>
            <p style="font-style: italic; border-top: 2px solid #e2e8f0; padding-top: 1.5rem; margin-top: 1.5rem; color: #6b7280;">
                Les boutons interactifs permettent d’alterner entre les modes de déplacement afin de comparer leur efficacité respective. Ce travail propose une lecture synthétique de l’accessibilité scolaire sur le territoire, et peut servir d’appui à la planification des mobilités durables à l’échelle locale.
            </p>
        </div>
    </div>
</div>
